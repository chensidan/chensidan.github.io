<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>FD正演测试-MTZ - Sidan</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Sidan Chen" /><meta name="description" content="Two-dimensional finite-difference synthetics FD正演模拟-MTZ界面下沉 服务器网址：北京超算计算云 1. 设置模型 设置模型边界异常点的位置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23" /><meta name="keywords" content="Hugo, Github" />






<meta name="generator" content="Hugo 0.99.1 with theme even" />


<link rel="canonical" href="https://chensidan.github.io/post/fdtest/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/reset-even.css">


<meta property="og:title" content="FD正演测试-MTZ" />
<meta property="og:description" content="Two-dimensional finite-difference synthetics FD正演模拟-MTZ界面下沉 服务器网址：北京超算计算云 1. 设置模型 设置模型边界异常点的位置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chensidan.github.io/post/fdtest/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-05-23T09:36:33+08:00" />
<meta property="article:modified_time" content="2022-05-23T09:36:33+08:00" />

<meta itemprop="name" content="FD正演测试-MTZ">
<meta itemprop="description" content="Two-dimensional finite-difference synthetics FD正演模拟-MTZ界面下沉 服务器网址：北京超算计算云 1. 设置模型 设置模型边界异常点的位置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23"><meta itemprop="datePublished" content="2022-05-23T09:36:33+08:00" />
<meta itemprop="dateModified" content="2022-05-23T09:36:33+08:00" />
<meta itemprop="wordCount" content="3368">
<meta itemprop="keywords" content="FD,GMT6,moveout," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="FD正演测试-MTZ"/>
<meta name="twitter:description" content="Two-dimensional finite-difference synthetics FD正演模拟-MTZ界面下沉 服务器网址：北京超算计算云 1. 设置模型 设置模型边界异常点的位置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Sidan Chen&#39;s Room</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于我</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Sidan Chen&#39;s Room</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于我</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">FD正演测试-MTZ</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-05-23 09:36 </span>
        <div class="post-category">
            <a href="/categories/%E6%AD%A3%E6%BC%94/"> 正演 </a>
            <a href="/categories/GMT6/"> GMT6 </a>
            <a href="/categories/moveout/"> moveout </a>
            </div>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#two-dimensional-finite-difference-synthetics">Two-dimensional finite-difference synthetics</a>
      <ul>
        <li><a href="#fd正演模拟-mtz界面下沉"><strong>FD正演模拟-MTZ界面下沉</strong></a>
          <ul>
            <li><a href="#1-设置模型">1. 设置模型</a></li>
            <li><a href="#2-合成模型">2. 合成模型</a></li>
            <li><a href="#3-绘制模型">3. 绘制模型</a></li>
            <li><a href="#4-修改参数利用服务器计算">4. 修改参数，利用服务器计算</a></li>
            <li><a href="#5-数据分析">5. 数据分析</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <head> 
    <script defer src="https://use.fontawesome.com/releases/v6.1.1/js/all.js"></script> 
    <script defer src="https://use.fontawesome.com/releases/v6.1.1/js/v4-shims.js"></script> 
</head> 
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.1/css/all.css">
<h1 id="two-dimensional-finite-difference-synthetics">Two-dimensional finite-difference synthetics</h1>
<h2 id="fd正演模拟-mtz界面下沉"><strong>FD正演模拟-MTZ界面下沉</strong></h2>
<p><strong>服务器网址：<a href="https://cloud.blsc.cn/">北京超算计算云</a></strong></p>
<h3 id="1-设置模型">1. 设置模型</h3>
<p><font size=2>设置模型边界异常点的位置</font></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash  
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">## This code can design the model of MTZ Boundry for different slope      	</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Created by Sidan, 2022-5-6				</span>
</span></span><span class="line"><span class="cl"><span class="c1">#:&lt;&lt;A    </span>
</span></span><span class="line"><span class="cl"><span class="c1"># generate Four file: hetbase.info &amp; disbase.info &amp; dis.info &amp; het.info    </span>
</span></span><span class="line"><span class="cl"><span class="c1"># First generate the File1 &amp; File2: hetbase.info &amp; disbase.info  </span>
</span></span><span class="line"><span class="cl">rm hetbase.info disbase.info  
</span></span><span class="line"><span class="cl"><span class="nv">File1</span><span class="o">=</span>hetbase.info      <span class="c1"># no data in hetbase.info  </span>
</span></span><span class="line"><span class="cl"><span class="nv">File2</span><span class="o">=</span>disbase.info      <span class="c1"># no need to change  </span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; Generate File1&amp;File2 *base.info no need to change &#34;</span>  
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; # grdsize=1.0; true pos: grdsize/x, true smooth:smooth*grdsize &#34;</span> &gt; hetbase.info  
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 00 0.0 0.0 0.0000 0.0000 0 0 &#34;</span> &gt;&gt; hetbase.info  
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 1 0 0 &#34;</span> &gt; disbase.info  
</span></span><span class="line"><span class="cl"><span class="c1"># Second generate the File3&amp;File4: dis.info &amp; het.info   </span>
</span></span><span class="line"><span class="cl">rm het.info dis.info  
</span></span><span class="line"><span class="cl"><span class="nv">x1</span><span class="o">=</span><span class="m">980</span>  
</span></span><span class="line"><span class="cl"><span class="nv">x2</span><span class="o">=</span><span class="m">1130</span>  
</span></span><span class="line"><span class="cl"><span class="nv">ddpath</span><span class="o">=</span><span class="m">30</span> 
</span></span><span class="line"><span class="cl"><span class="nv">slope</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="se">\$</span><span class="o">{</span>x1<span class="o">}</span> <span class="se">\$</span><span class="o">{</span>x2<span class="o">}</span> <span class="se">\$</span><span class="o">{</span>ddpath<span class="o">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print \$3/(\$2-\$1)}&#39;</span><span class="sb">`</span>  
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>x1<span class="p">;</span>i&lt;<span class="o">=</span>x2<span class="p">;</span>i++<span class="o">))</span><span class="p">;</span> <span class="k">do</span>  
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="si">${</span><span class="nv">i</span><span class="si">}</span> <span class="si">${</span><span class="nv">x1</span><span class="si">}</span> <span class="si">${</span><span class="nv">slope</span><span class="si">}</span><span class="p">|</span> awk <span class="s1">&#39;{print $1,660,660+($1-$2)*$3,0.00,0.00,20,20}&#39;</span> &gt;&gt; het.info  
</span></span><span class="line"><span class="cl"><span class="k">done</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">x1</span><span class="o">=</span><span class="m">1131</span>
</span></span><span class="line"><span class="cl"><span class="nv">x2</span><span class="o">=</span><span class="m">1430</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>x1<span class="p">;</span>i&lt;<span class="o">=</span>x2<span class="p">;</span>i++<span class="o">))</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="si">${</span><span class="nv">i</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1,660,690,0.00,0.00,20,20}&#39;</span> &gt;&gt; het.info
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">x1</span><span class="o">=</span><span class="m">1431</span>
</span></span><span class="line"><span class="cl"><span class="nv">x2</span><span class="o">=</span><span class="m">1630</span>
</span></span><span class="line"><span class="cl"><span class="nv">ddpath</span><span class="o">=</span><span class="m">30</span>
</span></span><span class="line"><span class="cl"><span class="nv">slope</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">x1</span><span class="si">}</span> <span class="si">${</span><span class="nv">x2</span><span class="si">}</span> <span class="si">${</span><span class="nv">ddpath</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $3/($2-$1)}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>x1<span class="p">;</span>i&lt;<span class="o">=</span>x2<span class="p">;</span>i++<span class="o">))</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="si">${</span><span class="nv">i</span><span class="si">}</span> <span class="si">${</span><span class="nv">x2</span><span class="si">}</span> <span class="si">${</span><span class="nv">slope</span><span class="si">}</span><span class="p">|</span> awk <span class="s1">&#39;{print $1,660,660+($2-$1)*$3,0.00,0.00,20,20}&#39;</span> &gt;&gt; het.info
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat het.info <span class="p">|</span> awk <span class="s1">&#39;NR&gt;2{print line}{line=$0}&#39;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1,$2,$3}&#39;</span> &gt; dis.info
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#A</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># GMT6 to check the dis.info </span>
</span></span><span class="line"><span class="cl">gmt begin newmodel png
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">R</span><span class="o">=</span>0/2560/640/700
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat dis.info <span class="p">|</span> awk <span class="s1">&#39;{print $1,$3}&#39;</span> <span class="p">|</span> gmt plot -R<span class="nv">$R</span> -Bxa400f50 -Bya20f10 -JX10c/-10c -W1,red,.
</span></span><span class="line"><span class="cl">cat dis.info <span class="p">|</span> awk <span class="s1">&#39;{print $1,$2}&#39;</span> <span class="p">|</span> gmt plot -R<span class="nv">$R</span> -Bxa400f50 -Bya20f10 -JX10c/-10c -W1,blue,.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt legend -DjBL+w3.5c+o0.2c/0.2c -F+p0.5p --FONT_ANNOT_PRIMARY<span class="o">=</span>10p  <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">S 0.2i c 0.1c blue 0.01c,blue 0.4i ISPV91
</span></span></span><span class="line"><span class="cl"><span class="s">S 0.2i c 0.1c red  0.01c,red 0.4i New-model
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt end show<span class="sb">`</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><font size=2>gmt生成模型的深度变化示意图</font></p>
<p><img src="https://raw.githubusercontent.com/chensidan/Picture/main/newmodel.png" alt="newmodel"></p>
<h3 id="2-合成模型">2. 合成模型</h3>
<p><font size=2>根据 wangxin 改的 get2Dmodel2.f90，来对mtz界面进行变化。该脚本只使用于 IASPV91，记得修改路径。详细参考 codes/get2Dmodel2.f90 &amp; changed.f90 </font></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># View the velocity model;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Generate background velocity model [no data in hetbase.info]</span>
</span></span><span class="line"><span class="cl">cp -r /home/meng/Documents/FDcodes/codes_sd ./
</span></span><span class="line"><span class="cl">cp /home/meng/Documents/FDcodes/IASP91 ./
</span></span><span class="line"><span class="cl">./codes_sd/bin/get2Dmodel2 IASP91 hetbase.info base <span class="m">2560</span> <span class="m">1600</span> 1.0 <span class="m">0</span> <span class="m">0</span> disbase.info
</span></span><span class="line"><span class="cl"><span class="c1"># Generate 2D FD velocity model</span>
</span></span><span class="line"><span class="cl">./codes_sd/bin/get2Dmodel2 IASP91 het.info mtz <span class="m">2560</span> <span class="m">1600</span> 1.0 <span class="m">0</span> <span class="m">0</span> dis.info
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-绘制模型">3. 绘制模型</h3>
<p><font size=2> 使用 GMT6 绘制2D模型，并同时绘制1D速度模型，进行对比 </font></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nv">nx</span><span class="o">=</span><span class="m">2560</span>
</span></span><span class="line"><span class="cl"><span class="nv">nz</span><span class="o">=</span><span class="m">1600</span>
</span></span><span class="line"><span class="cl"><span class="nv">h</span><span class="o">=</span>1.0
</span></span><span class="line"><span class="cl"><span class="nv">IN</span><span class="o">=</span>grdmtz.vp
</span></span><span class="line"><span class="cl"><span class="nv">INBACK</span><span class="o">=</span>grdbase.vp
</span></span><span class="line"><span class="cl"><span class="nv">R</span><span class="o">=</span>0/2560/-900/-300
</span></span><span class="line"><span class="cl"><span class="nv">x</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="m">8500</span> <span class="m">11000</span> <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print ($2-$1)/300}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">z</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> -800 -200 <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print ($2-$1)/300}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">x_1d</span><span class="o">=</span><span class="m">800</span>
</span></span><span class="line"><span class="cl"><span class="nv">xx_1d</span><span class="o">=</span><span class="m">1050</span>
</span></span><span class="line"><span class="cl"><span class="nv">xxx_1d</span><span class="o">=</span><span class="m">1280</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#:&lt;&lt;A</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Creat Fig for 2D model</span>
</span></span><span class="line"><span class="cl">gmt begin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	gmt makecpt -Cseis -T5/15/0.01 -Z -H &gt; vp.cpt
</span></span><span class="line"><span class="cl">	<span class="nv">gridnx</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">nx</span><span class="si">}</span> <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1*$2-$2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nv">gridnz</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">nz</span><span class="si">}</span> <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2-$1*$2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c1">## Create Fig1 and plot Inback picture</span>
</span></span><span class="line"><span class="cl">	gmt figure  Back-model png
</span></span><span class="line"><span class="cl">	gmt xyz2grd <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span> -G<span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>_p -I<span class="si">${</span><span class="nv">h</span><span class="si">}</span>/<span class="si">${</span><span class="nv">h</span><span class="si">}</span> -R0/<span class="si">${</span><span class="nv">gridnx</span><span class="si">}</span>/<span class="si">${</span><span class="nv">gridnz</span><span class="si">}</span>/0 -ZTLf
</span></span><span class="line"><span class="cl">	gmt basemap -JX<span class="si">${</span><span class="nv">x</span><span class="si">}</span>i/<span class="si">${</span><span class="nv">z</span><span class="si">}</span>i -R<span class="nv">$R</span> -Bxa200f100 -Bya100f50 -BnSWe+t<span class="s2">&#34;Background velocity model&#34;</span> -Y2i
</span></span><span class="line"><span class="cl">	gmt grdimage <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>_p  -R<span class="nv">$R</span>  -Cvp.cpt
</span></span><span class="line"><span class="cl">	gmt colorbar -Cvp.cpt -D10/-1/10/0.15h -B1+l<span class="s2">&#34;Vp(km/s)&#34;</span>
</span></span><span class="line"><span class="cl">gmt plot  -W1,.  <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -410
</span></span></span><span class="line"><span class="cl"><span class="s">9600 -410
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt plot  -W1,. <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -660
</span></span></span><span class="line"><span class="cl"><span class="s">9601 -660
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">## Create Fig2 and plot Innew picture</span>
</span></span><span class="line"><span class="cl">	gmt figure New-model png
</span></span><span class="line"><span class="cl">        gmt xyz2grd <span class="si">${</span><span class="nv">IN</span><span class="si">}</span> -G<span class="si">${</span><span class="nv">IN</span><span class="si">}</span>_p -I<span class="si">${</span><span class="nv">h</span><span class="si">}</span>/<span class="si">${</span><span class="nv">h</span><span class="si">}</span> -R0/<span class="si">${</span><span class="nv">gridnx</span><span class="si">}</span>/<span class="si">${</span><span class="nv">gridnz</span><span class="si">}</span>/0 -ZTLf
</span></span><span class="line"><span class="cl">        gmt basemap -JX<span class="si">${</span><span class="nv">x</span><span class="si">}</span>i/<span class="si">${</span><span class="nv">z</span><span class="si">}</span>i -R<span class="nv">$R</span> -Bxa200f100 -Bya100f50 -BnSWe+t<span class="s2">&#34;MTZ new velocity model&#34;</span> -Y2i
</span></span><span class="line"><span class="cl">        gmt grdimage <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>_p  -Cvp.cpt
</span></span><span class="line"><span class="cl">        gmt colorbar -Cvp.cpt -D10/-1/10/0.15h -B1+l<span class="s2">&#34;Vp(km/s)&#34;</span>
</span></span><span class="line"><span class="cl">gmt plot  -W1,.  <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -410
</span></span></span><span class="line"><span class="cl"><span class="s">9600 -410
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt plot  -W1,. <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -660
</span></span></span><span class="line"><span class="cl"><span class="s">9600 -660
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">## Create Fig3 and plot relative picture</span>
</span></span><span class="line"><span class="cl">        gmt figure relative-model png
</span></span><span class="line"><span class="cl">	gmt makecpt -Cseis -T-6.2/6.2/0.01 -Z -H &gt; vp_re.cpt
</span></span><span class="line"><span class="cl">	gmt grdmath <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>_p NEG <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>_p ADD <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>_p DIV <span class="m">100</span> <span class="nv">MUL</span> <span class="o">=</span> het.grd
</span></span><span class="line"><span class="cl">        gmt basemap -JX<span class="si">${</span><span class="nv">x</span><span class="si">}</span>i/<span class="si">${</span><span class="nv">z</span><span class="si">}</span>i -R<span class="nv">$R</span> -Bxa200f100 -Bya100f50 -BnSWe+t<span class="s2">&#34;Relative velocity model&#34;</span> -Y2i
</span></span><span class="line"><span class="cl">        gmt grdimage het.grd -R<span class="nv">$R</span> -JX<span class="si">${</span><span class="nv">x</span><span class="si">}</span>i/<span class="si">${</span><span class="nv">z</span><span class="si">}</span>i  -Cvp_re.cpt
</span></span><span class="line"><span class="cl">	gmt colorbar -Cvp_re.cpt -D10/-1/10/0.15h -B1+l<span class="s2">&#34;Vp perturbation (%)&#34;</span>
</span></span><span class="line"><span class="cl">gmt plot  -W1,.  <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -410
</span></span></span><span class="line"><span class="cl"><span class="s">9600 -410
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt plot  -W1,. <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -660
</span></span></span><span class="line"><span class="cl"><span class="s">9600 -660
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt end show
</span></span><span class="line"><span class="cl">A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Create Fig for 1D-velocity model</span>
</span></span><span class="line"><span class="cl">gmt grd2xyz <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>_p &gt; <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz
</span></span><span class="line"><span class="cl">gmt grd2xyz <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>_p &gt; <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz
</span></span><span class="line"><span class="cl">cat <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz <span class="p">|</span> grep ^<span class="si">${</span><span class="nv">x_1d</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">x_1d</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">cat <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz <span class="p">|</span> grep ^<span class="si">${</span><span class="nv">x_1d</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">x_1d</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">cat <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz <span class="p">|</span> grep ^<span class="si">${</span><span class="nv">xx_1d</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xx_1d</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">cat <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz <span class="p">|</span> grep ^<span class="si">${</span><span class="nv">xx_1d</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xx_1d</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">cat <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz <span class="p">|</span> grep ^<span class="si">${</span><span class="nv">xxx_1d</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xxx_1d</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">cat <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz <span class="p">|</span> grep ^<span class="si">${</span><span class="nv">xxx_1d</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xxx_1d</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">R2</span><span class="o">=</span>5/15/100/1200
</span></span><span class="line"><span class="cl">gmt begin 1D-model png
</span></span><span class="line"><span class="cl">	gmt <span class="nb">set</span> FONT_TAG 15p FONT_HEADING 20p MAP_HEADING_OFFSET 0p
</span></span><span class="line"><span class="cl">	gmt subplot begin 1x3 -Fs8c/20c -A -M0.5c/0.1c -T<span class="s2">&#34;1D velocity model&#34;</span>
</span></span><span class="line"><span class="cl">	gmt subplot <span class="nb">set</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">	gmt basemap -R<span class="nv">$R2</span> -JX8c/-20c -Bx1+l<span class="s2">&#34;Velocity(km/s)&#34;</span> -Bya50f10+l<span class="s2">&#34;Depth(km)&#34;</span> -BWenS
</span></span><span class="line"><span class="cl">	cat <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">x_1d</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $3,-$2}&#39;</span> <span class="p">|</span> gmt plot -W1.5p,blue
</span></span><span class="line"><span class="cl">	cat <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">x_1d</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $3,-$2}&#39;</span> <span class="p">|</span> gmt plot -W1.5p,red
</span></span><span class="line"><span class="cl">gmt plot -W1.5p,black,-  <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">5 410
</span></span></span><span class="line"><span class="cl"><span class="s">15 410
</span></span></span><span class="line"><span class="cl"><span class="s">&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">5 660
</span></span></span><span class="line"><span class="cl"><span class="s">15 660
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">gmt legend -DjBL+w4c+o0.2c/0.2c -F+p0.5p --FONT_ANNOT_PRIMARY<span class="o">=</span>10p  <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">H 12p,Times-Roman x= 800 1050 1280
</span></span></span><span class="line"><span class="cl"><span class="s">S 0.2i - 0.4i blue 0.04c,blue 0.6i ISPV91
</span></span></span><span class="line"><span class="cl"><span class="s">S 0.2i - 0.4i red 0.04c,red  0.6i New-model
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	gmt subplot <span class="nb">set</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">	gmt basemap -R<span class="nv">$R2</span> -JX8c/-20c -Bx1+l<span class="s2">&#34;Velocity(km/s)&#34;</span> -Bya50f10+l<span class="s2">&#34;Depth(km)&#34;</span> -BwenS
</span></span><span class="line"><span class="cl">        cat <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xx_1d</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $3,-$2}&#39;</span> <span class="p">|</span> gmt plot -W1.5p,blue
</span></span><span class="line"><span class="cl">        cat <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xx_1d</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $3,-$2}&#39;</span> <span class="p">|</span> gmt plot -W1.5p,red
</span></span><span class="line"><span class="cl">gmt plot -W1.5p,black,-  <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">5 410
</span></span></span><span class="line"><span class="cl"><span class="s">15 410
</span></span></span><span class="line"><span class="cl"><span class="s">&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">5 660
</span></span></span><span class="line"><span class="cl"><span class="s">15 660
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	gmt subplot <span class="nb">set</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">        gmt basemap -R<span class="nv">$R2</span> -JX8c/-20c -Bx1+l<span class="s2">&#34;Velocity(km/s)&#34;</span> -Bya50f10+l<span class="s2">&#34;Depth(km)&#34;</span> -BwEnS
</span></span><span class="line"><span class="cl">        cat <span class="si">${</span><span class="nv">INBACK</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xxx_1d</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $3,-$2}&#39;</span> <span class="p">|</span> gmt plot -W1.5p,blue
</span></span><span class="line"><span class="cl">        cat <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>.xyz.<span class="si">${</span><span class="nv">xxx_1d</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $3,-$2}&#39;</span> <span class="p">|</span> gmt plot -W1.5p,red
</span></span><span class="line"><span class="cl">gmt plot -W1.5p,black,-  <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">5 410
</span></span></span><span class="line"><span class="cl"><span class="s">15 410
</span></span></span><span class="line"><span class="cl"><span class="s">&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">5 660
</span></span></span><span class="line"><span class="cl"><span class="s">15 660
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">	gmt subplot end
</span></span><span class="line"><span class="cl">gmt end show
</span></span><span class="line"><span class="cl">rm *.xyz* 
</span></span><span class="line"><span class="cl"><span class="c1">#gmt grdmath ${INBACK}_p NEG ${IN}_p ADD  = het.grd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><font size=2> 将生成四张图，分别是背景模型、相对模型、绝对模型于特定x点位的1D模型，以下为绝对模型与1D模型示例：</font>
<img src="https://raw.githubusercontent.com/chensidan/Picture/main/New-model.png" alt="绝对模型">
<img src="https://raw.githubusercontent.com/chensidan/Picture/main/1D-model.png" alt="1D模型"></p>
<p><i class="fa-regular fa-star"></i><font size=2> 在设置模型时，有一个波会干扰到目标震相，猜测是由于上边界反射的某种波，因此设置两个预留边界&gt;300km，来削弱它在目标范围内的影响</font></p>
<h3 id="4-修改参数利用服务器计算">4. 修改参数，利用服务器计算</h3>
<p><font size=2> 合并 in_par.UW 与 run 脚本，循环多个炮点与检波器，实现滚采 </font></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH -M swarm</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH -p gpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --gres=gpu:1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This script is merged by in_par.uw and run.sh #</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      Writen by Sidan, 2022-5-9                #</span>
</span></span><span class="line"><span class="cl"><span class="c1">#################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> xs in <span class="sb">`</span>seq <span class="m">775</span> <span class="m">20</span> 1835<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir source_<span class="si">${</span><span class="nv">xs</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">nt</span><span class="o">=</span><span class="m">40001</span>
</span></span><span class="line"><span class="cl"><span class="nv">nx</span><span class="o">=</span><span class="m">2560</span>
</span></span><span class="line"><span class="cl"><span class="nv">nz</span><span class="o">=</span><span class="m">1600</span>
</span></span><span class="line"><span class="cl"><span class="nv">nt</span><span class="o">=</span><span class="m">40001</span>   	<span class="c1">#  source position</span>
</span></span><span class="line"><span class="cl"><span class="nv">zs</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">h</span><span class="o">=</span>1.0
</span></span><span class="line"><span class="cl"><span class="nv">dt</span><span class="o">=</span>0.01
</span></span><span class="line"><span class="cl"><span class="nv">nrec</span><span class="o">=</span>53	 	<span class="c1">#   for line record</span>
</span></span><span class="line"><span class="cl"><span class="nv">ixrec0</span><span class="o">=</span><span class="m">780</span>
</span></span><span class="line"><span class="cl"><span class="nv">idxrec</span><span class="o">=</span><span class="m">20</span>           <span class="c1">#   line record dx</span>
</span></span><span class="line"><span class="cl"><span class="nv">model</span><span class="o">=</span>grdmtz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">usebox=0 
</span></span></span><span class="line"><span class="cl"><span class="s2">nt=</span><span class="nv">$nt</span><span class="s2">                     
</span></span></span><span class="line"><span class="cl"><span class="s2">ngpu=1
</span></span></span><span class="line"><span class="cl"><span class="s2">gpuid=0            
</span></span></span><span class="line"><span class="cl"><span class="s2">nx=</span><span class="nv">$nx</span><span class="s2">                #  x direction, will be multiple of 32
</span></span></span><span class="line"><span class="cl"><span class="s2">nz=</span><span class="nv">$nz</span><span class="s2">                #  z direction, will be multiple of 16
</span></span></span><span class="line"><span class="cl"><span class="s2">xs=</span><span class="nv">$xs</span><span class="s2">                #  source position, the souce located on Txx,Tzz grid
</span></span></span><span class="line"><span class="cl"><span class="s2">zs=</span><span class="nv">$zs</span><span class="s2">                 #  source position
</span></span></span><span class="line"><span class="cl"><span class="s2">h=</span><span class="nv">$h</span><span class="s2">                  #  grid size 
</span></span></span><span class="line"><span class="cl"><span class="s2">dt=</span><span class="nv">$dt</span><span class="s2">                #  time step size
</span></span></span><span class="line"><span class="cl"><span class="s2">srctype=1              #  1 for 2D line, p for p
</span></span></span><span class="line"><span class="cl"><span class="s2">srctime=g             #  t for triangle, g for gaussian
</span></span></span><span class="line"><span class="cl"><span class="s2">trap1=0.5            #  trap1,trap2,trap3 for triangle
</span></span></span><span class="line"><span class="cl"><span class="s2">trap2=0.0            #   
</span></span></span><span class="line"><span class="cl"><span class="s2">trap3=0.5            #   
</span></span></span><span class="line"><span class="cl"><span class="s2">alpha=-40            #  &lt;0 for gaussian, bell length is about 6*alpha  
</span></span></span><span class="line"><span class="cl"><span class="s2">strike=231            #   
</span></span></span><span class="line"><span class="cl"><span class="s2">dip=35               #   
</span></span></span><span class="line"><span class="cl"><span class="s2">rake=138             #     
</span></span></span><span class="line"><span class="cl"><span class="s2">azimuth=90           #   
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">                   #      
</span></span></span><span class="line"><span class="cl"><span class="s2">itprint=100        #     
</span></span></span><span class="line"><span class="cl"><span class="s2">npml=32            #   pml need to be toned if you want good result
</span></span></span><span class="line"><span class="cl"><span class="s2">pml_dt=0.001      #   pml dt, similar to dt
</span></span></span><span class="line"><span class="cl"><span class="s2">pml_v=30           #   pml v, similar to vp
</span></span></span><span class="line"><span class="cl"><span class="s2">pml_r=1E-11        #   pml r, target reflection coefficient
</span></span></span><span class="line"><span class="cl"><span class="s2">pml_fc=2           #   pml frequency
</span></span></span><span class="line"><span class="cl"><span class="s2">itrecord=1         #   record every itrecord step
</span></span></span><span class="line"><span class="cl"><span class="s2">output=test            #   tag name, output_U.isis
</span></span></span><span class="line"><span class="cl"><span class="s2">U_sta_file=        #   if specified, read receiver (z,x) pairs from file
</span></span></span><span class="line"><span class="cl"><span class="s2">W_sta_file=        #   if specified, read receiver (z,x) pairs from file
</span></span></span><span class="line"><span class="cl"><span class="s2">   
</span></span></span><span class="line"><span class="cl"><span class="s2">nrec=</span><span class="nv">$nrec</span><span class="s2">              #   for line record
</span></span></span><span class="line"><span class="cl"><span class="s2">ixrec0=</span><span class="nv">$ixrec0</span><span class="s2">          #   first x0
</span></span></span><span class="line"><span class="cl"><span class="s2">izrec0_u=0          #   z0 for u, 0 is the surface for u 
</span></span></span><span class="line"><span class="cl"><span class="s2">izrec0_w=1          #   z0 for w, 1 is the surface for w
</span></span></span><span class="line"><span class="cl"><span class="s2">idxrec=</span><span class="nv">$idxrec</span><span class="s2">           #   line record dx
</span></span></span><span class="line"><span class="cl"><span class="s2">idzrec=0            #   line record dz
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">                   #      
</span></span></span><span class="line"><span class="cl"><span class="s2">model=</span><span class="nv">$model</span><span class="s2">        #   model tag, read model.vp model.vs model.den
</span></span></span><span class="line"><span class="cl"><span class="s2">usetable=1         #   =1 make table, maybe slow
</span></span></span><span class="line"><span class="cl"><span class="s2">ntsnap=1000   #   snapshot every ntstep
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">usepunch=0        #   use punch
</span></span></span><span class="line"><span class="cl"><span class="s2">before=20           #        
</span></span></span><span class="line"><span class="cl"><span class="s2">after=100            #         
</span></span></span><span class="line"><span class="cl"><span class="s2">velfile=</span><span class="nv">$model</span><span class="s2">.vp&#34;</span> &gt; source_<span class="si">${</span><span class="nv">xs</span><span class="si">}</span>/in.par_UW_<span class="si">${</span><span class="nv">xs</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> source_<span class="si">${</span><span class="nv">xs</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">################ run.sh</span>
</span></span><span class="line"><span class="cl">cp ../grd* ./
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rm U*
</span></span><span class="line"><span class="cl">rm W*
</span></span><span class="line"><span class="cl">rm -r test_U.isis_vel
</span></span><span class="line"><span class="cl">rm -r test_W.isis_vel
</span></span><span class="line"><span class="cl">rm test_U.isis
</span></span><span class="line"><span class="cl">rm test_U
</span></span><span class="line"><span class="cl">rm test_W.isis
</span></span><span class="line"><span class="cl">rm test_W
</span></span><span class="line"><span class="cl">rm V*
</span></span><span class="line"><span class="cl">rm -r test_V.isis_vel
</span></span><span class="line"><span class="cl">rm test_V.isis
</span></span><span class="line"><span class="cl">rm test_V
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nbpsv2d <span class="nv">par</span><span class="o">=</span>in.par_UW_<span class="si">${</span><span class="nv">xs</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># using matlab to process to get seismogram, nt is the same as in the par file or less than it</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the </span>
</span></span><span class="line"><span class="cl">matlab <span class="s">&lt;&lt; END
</span></span></span><span class="line"><span class="cl"><span class="s">addpath /home/hanguangji/project/Workdr/chen/script
</span></span></span><span class="line"><span class="cl"><span class="s">nt=40000;
</span></span></span><span class="line"><span class="cl"><span class="s">isis2vel_true_pos(&#39;test_W.isis&#39;,nt);  % vertical component
</span></span></span><span class="line"><span class="cl"><span class="s">isis2vel_true_pos(&#39;test_U.isis&#39;,nt);  % radial component
</span></span></span><span class="line"><span class="cl"><span class="s">exit
</span></span></span><span class="line"><span class="cl"><span class="s">END</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><font size=2> 超算提交任务指令: <code>sbtach finalrun.sh</code> ; 查看队列: <code>squeue</code>，剩下的不记得了，以后再补。。。</font></p>
<h3 id="5-数据分析">5. 数据分析</h3>
<h4 id="51-数据准备自激自收">5.1 数据准备&amp;&amp;自激自收</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">SAC_DISPLAY_COPYRIGHT</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">############################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It&#39;s used to bandpass the waves and plot #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Writed by Sidan, 2022-5-10		   #</span>
</span></span><span class="line"><span class="cl"><span class="c1">############################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">file</span><span class="o">=</span>filelist
</span></span><span class="line"><span class="cl"><span class="nv">file2</span><span class="o">=</span>temp
</span></span><span class="line"><span class="cl"><span class="nv">bp1</span><span class="o">=</span>0.1
</span></span><span class="line"><span class="cl"><span class="nv">bp2</span><span class="o">=</span>0.2
</span></span><span class="line"><span class="cl"><span class="nv">datapath</span><span class="o">=</span>/media/meng/chensd2/Syth/SYN_FD/Test_My/test_mtz2/fd_syn/source_1
</span></span><span class="line"><span class="cl">ls <span class="nv">$datapath</span>/source_*/*/s*.sac &gt; <span class="nv">$datapath</span>/<span class="nv">$file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Write source and station loc, then bandpass</span>
</span></span><span class="line"><span class="cl"><span class="c1">#:&lt;&lt;A</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; Write source and station loc, then bandpass : &#34;</span>
</span></span><span class="line"><span class="cl">cat <span class="nv">$file</span> <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl"><span class="nv">x_source</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> awk -F <span class="s1">&#39;/&#39;</span> <span class="s1">&#39;{print $11}&#39;</span> <span class="p">|</span> awk -F <span class="s1">&#39;_&#39;</span> <span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">x_sta</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> awk -F <span class="s1">&#39;/&#39;</span> <span class="s1">&#39;{print $13}&#39;</span><span class="p">|</span> awk -F <span class="o">[</span>s,.<span class="o">]</span> <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> sed -r <span class="s1">&#39;s/0*([0-9])/\1/&#39;</span> <span class="p">|</span> awk <span class="s1">&#39;{print ($1-1)*20+780}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="c1">#:&lt;&lt;A</span>
</span></span><span class="line"><span class="cl">sac <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">r $line
</span></span></span><span class="line"><span class="cl"><span class="s">ch stlo $x_sta evlo $x_source
</span></span></span><span class="line"><span class="cl"><span class="s">wh
</span></span></span><span class="line"><span class="cl"><span class="s">r $line
</span></span></span><span class="line"><span class="cl"><span class="s">bp c $bp1 $bp2 n 2 p 2
</span></span></span><span class="line"><span class="cl"><span class="s">w append .bl
</span></span></span><span class="line"><span class="cl"><span class="s">q
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">A
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:<span class="s">&lt;&lt;B
</span></span></span><span class="line"><span class="cl"><span class="s">saclst dist f  $datapath/source_*/*/s*.sac.bl  | sort -t_ -k7n &gt; $file2
</span></span></span><span class="line"><span class="cl"><span class="s">#:&lt;&lt;B</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plot Self excitation-retraction  and model by GMT6</span>
</span></span><span class="line"><span class="cl">gmt begin 
</span></span><span class="line"><span class="cl">	gmt figure model-source pdf
</span></span><span class="line"><span class="cl">	<span class="nv">nx</span><span class="o">=</span><span class="m">2560</span>
</span></span><span class="line"><span class="cl">	<span class="nv">nz</span><span class="o">=</span><span class="m">1600</span>
</span></span><span class="line"><span class="cl">	<span class="nv">h</span><span class="o">=</span>1.0
</span></span><span class="line"><span class="cl">	<span class="nv">IN</span><span class="o">=</span>/media/meng/chensd2/Syth/SYN_FD/Test_My/test_mtz2/grdmtz.vp
</span></span><span class="line"><span class="cl">	<span class="nv">R</span><span class="o">=</span>0/2560/-900/-300
</span></span><span class="line"><span class="cl">	<span class="nv">x</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="m">8500</span> <span class="m">11000</span> <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print ($2-$1)/300}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nv">z</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> -800 -200 <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print ($2-$1)/300}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nv">gridnx</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">nx</span><span class="si">}</span> <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1*$2-$2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">        <span class="nv">gridnz</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">nz</span><span class="si">}</span> <span class="si">${</span><span class="nv">h</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2-$1*$2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	gmt makecpt -Cseis -T5/15/0.01 -Z -H &gt; vp.cpt
</span></span><span class="line"><span class="cl">	gmt xyz2grd <span class="si">${</span><span class="nv">IN</span><span class="si">}</span> -G<span class="si">${</span><span class="nv">IN</span><span class="si">}</span>_p -I<span class="si">${</span><span class="nv">h</span><span class="si">}</span>/<span class="si">${</span><span class="nv">h</span><span class="si">}</span> -R0/<span class="si">${</span><span class="nv">gridnx</span><span class="si">}</span>/<span class="si">${</span><span class="nv">gridnz</span><span class="si">}</span>/0 -ZTLf
</span></span><span class="line"><span class="cl">        gmt basemap -JX<span class="si">${</span><span class="nv">x</span><span class="si">}</span>i/<span class="si">${</span><span class="nv">z</span><span class="si">}</span>i -R<span class="nv">$R</span> -Bxa200f100 -Bya100f50 -BnSWe+t<span class="s2">&#34;MTZ new velocity model&#34;</span> -Y2i
</span></span><span class="line"><span class="cl">        gmt grdimage <span class="si">${</span><span class="nv">IN</span><span class="si">}</span>_p  -Cvp.cpt
</span></span><span class="line"><span class="cl">        gmt colorbar -Cvp.cpt -D10/-1/10/0.15h -B1+l<span class="s2">&#34;Vp(km/s)&#34;</span>
</span></span><span class="line"><span class="cl">gmt plot  -W1,.  <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -410
</span></span></span><span class="line"><span class="cl"><span class="s">9600 -410
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt plot  -W1,. <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">0 -660
</span></span></span><span class="line"><span class="cl"><span class="s">9600 -660
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">seq <span class="m">780</span> <span class="m">20</span> <span class="m">1820</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1,-300}&#39;</span> <span class="p">|</span> gmt plot -St0.1c -W1p,blue -D0/0.03c -N -Gblue
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	gmt figure Self-exci-retr pdf 
</span></span><span class="line"><span class="cl">	cat <span class="si">${</span><span class="nv">file2</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{if($2==4.5) print $1}&#39;</span> <span class="p">|</span>sort -t_ -k7n<span class="p">|</span> gmt sac -JX20c/-15c -R-2/54/80/240 -C80/240 -En -Bya50f10+l<span class="s2">&#34;Time(s)&#34;</span> -Bxa5+l<span class="s2">&#34;Station-th&#34;</span> -W0.3p,black -Q -M1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt end show
</span></span><span class="line"><span class="cl">B
</span></span></code></pre></td></tr></table>
</div>
</div><p><font size=2>将对应的台站与源的x轴位置写入stlo与evlo中，方便后续处理。同时在原模型基础上绘制台站位置与自激自收结果，观察Pv410P、Pv660P信号变化。如图：</font>
<img src="https://raw.githubusercontent.com/chensidan/Picture/main/self-exci-retr.png" alt="自激自收"></p>
<p><img src="https://raw.githubusercontent.com/chensidan/Picture/main/model-source.png" alt="台站布设"></p>
<h4 id="52-数据-cut--moveout--normalize">5.2 数据 cut &amp;&amp; moveout &amp;&amp; normalize</h4>
<p><font size=2> 我们只处理震中距两百公里以内的台站-震源对数据（详见5.4 理论模型测试），将数据以80-125s、125-175s与175-240s为分段进行动校正，再补零合并，最后归一化。</font></p>
<blockquote>
<p><code>1.	Datacut.sh</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">export</span> <span class="nv">SAC_DISPLAY_COPYRIGHT</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This code is used to cut Data for 410km(80-125s) &amp; 660km(125-175s)  #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Writen by Sidan , 2022-5-12                                         #</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="sb">`</span>cat filelist<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">t1</span><span class="o">=</span><span class="m">80</span>
</span></span><span class="line"><span class="cl"><span class="nv">t2</span><span class="o">=</span><span class="m">125</span>
</span></span><span class="line"><span class="cl"><span class="nv">t3</span><span class="o">=</span><span class="m">175</span>
</span></span><span class="line"><span class="cl"><span class="nv">t4</span><span class="o">=</span><span class="m">240</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sac <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">cut $t1 $t2
</span></span></span><span class="line"><span class="cl"><span class="s">r $i
</span></span></span><span class="line"><span class="cl"><span class="s">w append _41
</span></span></span><span class="line"><span class="cl"><span class="s">cut off
</span></span></span><span class="line"><span class="cl"><span class="s">cut $t2 $t3
</span></span></span><span class="line"><span class="cl"><span class="s">r $i
</span></span></span><span class="line"><span class="cl"><span class="s">w append _66
</span></span></span><span class="line"><span class="cl"><span class="s">cut off
</span></span></span><span class="line"><span class="cl"><span class="s">cut $t3 $t4
</span></span></span><span class="line"><span class="cl"><span class="s">r $i
</span></span></span><span class="line"><span class="cl"><span class="s">w append _low
</span></span></span><span class="line"><span class="cl"><span class="s">cut off
</span></span></span><span class="line"><span class="cl"><span class="s">q
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>2.	moveout.sh</code></p>
</blockquote>
<p><strong><font size=2> 参考资料：<a href="https://wenku.baidu.com/view/7fffed5b1411cc7931b765ce050876323012745d.html">动校正ppt</a> </font></strong></p>
<p><strong><font size=2> 已知自激自收反射时间与反射界面位置：</font></strong></p>
<p>$$
\Delta t = \sqrt{\frac{x^2}{V^2}+t_0^2}-t_0，
t_0 =\frac{2h}{V}
$$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">export</span> <span class="nv">SAC_DISPLAY_COPYRIGHT</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This code is used to moveout Data for Pv410P &amp; Pv660P		      #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Writen by Sidan , 2022-5-13                                         #</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:<span class="s">&lt;&lt;B
</span></span></span><span class="line"><span class="cl"><span class="s">## Target signal is Pv410P
</span></span></span><span class="line"><span class="cl"><span class="s">cat temp1 | while read line
</span></span></span><span class="line"><span class="cl"><span class="s">do
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">	x=`saclst stlo evlo f $line | awk &#39;{print sqrt(($2-$3)^2)}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">	echo &#34; The dist is $x &#34;
</span></span></span><span class="line"><span class="cl"><span class="s">	det_t=`echo $x | awk &#39;{print sqrt($1^2/8.1707^2+100.3586^2)-100.3586}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">	echo $det_t
</span></span></span><span class="line"><span class="cl"><span class="s">	old_b=`saclst b f $line | awk &#39;{print $2}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">	new_b=`echo $old_b $det_t | awk &#39;{print $1-$2}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">sac &lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">r $line
</span></span></span><span class="line"><span class="cl"><span class="s">ch b $new_b
</span></span></span><span class="line"><span class="cl"><span class="s">wh
</span></span></span><span class="line"><span class="cl"><span class="s">q
</span></span></span><span class="line"><span class="cl"><span class="s">EOF
</span></span></span><span class="line"><span class="cl"><span class="s">done
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">## Target signal is Pv660P
</span></span></span><span class="line"><span class="cl"><span class="s">cat temp2 | while read line
</span></span></span><span class="line"><span class="cl"><span class="s">do
</span></span></span><span class="line"><span class="cl"><span class="s">	x=`saclst stlo evlo f $line | awk &#39;{print sqrt(($2-$3)^2)}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">	echo &#34; The dist is $x &#34;
</span></span></span><span class="line"><span class="cl"><span class="s">	det_t=`echo $x | awk &#39;{print sqrt($1^2/8.7125^2+151.506^2)-151.506}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">	echo $det_t
</span></span></span><span class="line"><span class="cl"><span class="s">	old_b=`saclst b f $line | awk &#39;{print $2}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">        new_b=`echo $old_b $det_t | awk &#39;{print $1-$2}&#39;`
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">sac &lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">r $line
</span></span></span><span class="line"><span class="cl"><span class="s">ch b $new_b
</span></span></span><span class="line"><span class="cl"><span class="s">wh
</span></span></span><span class="line"><span class="cl"><span class="s">q
</span></span></span><span class="line"><span class="cl"><span class="s">EOF
</span></span></span><span class="line"><span class="cl"><span class="s">done
</span></span></span><span class="line"><span class="cl"><span class="s">B</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#:&lt;&lt;C</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Merge with gap zero</span>
</span></span><span class="line"><span class="cl">ls -d source_* &gt; temp3
</span></span><span class="line"><span class="cl">cat temp3 <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">cd</span> <span class="nv">$line</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34; This processing is coming to </span><span class="nv">$line</span><span class="s2"> &#34;</span>
</span></span><span class="line"><span class="cl">	ls s*.sac &gt; filelist
</span></span><span class="line"><span class="cl">	cat filelist <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line2
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">sac <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">merge GAP ZERO ${line2}_41 ${line2}_66 ${line2}_low 
</span></span></span><span class="line"><span class="cl"><span class="s">w ${line2}_nm
</span></span></span><span class="line"><span class="cl"><span class="s">cut 80 e
</span></span></span><span class="line"><span class="cl"><span class="s">r ${line2}_nm
</span></span></span><span class="line"><span class="cl"><span class="s">w over
</span></span></span><span class="line"><span class="cl"><span class="s">q
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>3.	normal.sh</code></p>
</blockquote>
<p><font size=2> 利用sac进行归一化 </font></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">export</span> <span class="nv">SAC_DISPLAY_COPYRIGHT</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This code is used to normalize data	      #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Writen by Sidan , 2022-5-13                                         #</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Normalize</span>
</span></span><span class="line"><span class="cl">ls -d source_* &gt; temp3
</span></span><span class="line"><span class="cl">cat temp3 <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">cd</span> <span class="nv">$line</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34; This processing is coming to </span><span class="nv">$line</span><span class="s2"> &#34;</span>
</span></span><span class="line"><span class="cl">	ls s*.sac_nm &gt; filelist
</span></span><span class="line"><span class="cl">	cat filelist <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line2
</span></span><span class="line"><span class="cl">		<span class="k">do</span>
</span></span><span class="line"><span class="cl">		<span class="nv">depmax</span><span class="o">=</span><span class="sb">`</span>saclst depmax f  <span class="si">${</span><span class="nv">line2</span><span class="si">}</span><span class="p">|</span>awk <span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">sac <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">r ${line2}
</span></span></span><span class="line"><span class="cl"><span class="s">div $depmax
</span></span></span><span class="line"><span class="cl"><span class="s">w append .d
</span></span></span><span class="line"><span class="cl"><span class="s">q
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="53-叠加-stack">5.3 叠加 stack</h4>
<p><font size=2> 采用共中心点、ts_pws相位加权叠加方式；以25km为的原点，50km为叠加半径进行区域叠加</font></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">export</span> <span class="nv">SAC_DISPLAY_COPYRIGHT</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This code is used to stack sac data	      #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Writen by Sidan , 2022-5-13                                         #</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## stack by ts_pws</span>
</span></span><span class="line"><span class="cl"><span class="c1">#:&lt;&lt;A</span>
</span></span><span class="line"><span class="cl"><span class="c1"># calculate reflect point_x ($refl)</span>
</span></span><span class="line"><span class="cl">rm stack.lst
</span></span><span class="line"><span class="cl">ls source_*/*.d &gt; temp4
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;### saclist stlo evlo refl&#34;</span> &gt; stack.lst
</span></span><span class="line"><span class="cl">cat temp4 <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nv">stlo</span><span class="o">=</span><span class="sb">`</span>saclst stlo f <span class="si">${</span><span class="nv">line</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nv">evlo</span><span class="o">=</span><span class="sb">`</span>saclst evlo f <span class="si">${</span><span class="nv">line</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nv">refl</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$stlo</span> <span class="nv">$evlo</span> <span class="p">|</span> awk <span class="s1">&#39;{if($1&gt;$2){print (($1-$2)/2)+$2;} else {print ($2-$1)/2+$1;}}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$line</span><span class="s2"> </span><span class="nv">$stlo</span><span class="s2"> </span><span class="nv">$evlo</span><span class="s2"> </span><span class="nv">$refl</span><span class="s2">&#34;</span> &gt;&gt; stack.lst
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#  stack form 800 to 1750</span>
</span></span><span class="line"><span class="cl"><span class="nv">r</span><span class="o">=</span><span class="m">50</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">800</span> <span class="m">25</span> 1750<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34; This processing is coming to X = </span><span class="nv">$i</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nv">x1</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$r</span> <span class="nv">$i</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2-$1}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nv">x2</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$r</span> <span class="nv">$i</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2+$1}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="nv">$x1</span> <span class="nv">$x2</span>
</span></span><span class="line"><span class="cl">	cat stack.lst <span class="p">|</span> awk -v <span class="nv">x1</span><span class="o">=</span><span class="nv">$x1</span> -v <span class="nv">x2</span><span class="o">=</span><span class="nv">$x2</span> <span class="s1">&#39;{if($4&gt;x1&amp;&amp;$4&lt;x2) print $1}&#39;</span> &gt; stack.<span class="si">${</span><span class="nv">i</span><span class="si">}</span>.lst
</span></span><span class="line"><span class="cl">	ts_pws stack.<span class="si">${</span><span class="nv">i</span><span class="si">}</span>.lst <span class="nv">osac</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> 
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="54-画图-gmt6">5.4 画图 GMT6</h4>
<p><font size=2> pws结果滤波至0.1-0.2hz </font></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This code is used to plot stack sac data	      #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Writen by Sidan , 2022-5-13                                         #</span>
</span></span><span class="line"><span class="cl"><span class="c1">#######################################################################</span>
</span></span><span class="line"><span class="cl">rm temp6
</span></span><span class="line"><span class="cl">ls ts_pws*.sac.bl  <span class="p">|</span> sort -t_ -k3n  &gt; temp5
</span></span><span class="line"><span class="cl"><span class="nv">file</span><span class="o">=</span>temp5
</span></span><span class="line"><span class="cl">cat <span class="nv">$file</span> <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nv">x</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span>awk -F <span class="o">[</span>_,.<span class="o">]</span> <span class="s1">&#39;{print $3}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="nv">$line</span> <span class="nv">$x</span> <span class="m">80</span> &gt;&gt; temp6
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt begin stackline pdf
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">cat temp6 <span class="p">|</span> gmt sac -JX20c/-15c -R790/1760/80/240 -C80/240 -Bya50f10+l<span class="s2">&#34;Time(s)&#34;</span> -Bxa100+l<span class="s2">&#34;x_location&#34;</span> -W0.3p,black -Q -M2 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gmt end show
</span></span></code></pre></td></tr></table>
</div>
</div><p><font size=2> 如下图,倾斜界面确实存在由于叠加信号会导致反射信号削弱的现象： </font>
<img src="https://raw.githubusercontent.com/chensidan/Picture/main/stackline.png" alt="linetest"></p>
<p><font size=2> 理论ak135模型测试，震源位于模型中间，布设了一系列线性台阵：</font></p>
<p><img src="https://raw.githubusercontent.com/chensidan/Picture/main/waves_bp0.1_0.2.png" alt="ak135syn"></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Sidan Chen</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2022-05-23 09:36
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/FD/">FD</a>
          <a href="/tags/GMT6/">GMT6</a>
          <a href="/tags/moveout/">moveout</a>
          </div>
      <nav class="post-nav">
        
        <a class="next" href="/post/hugouse/">
            <span class="next-text nav-default">搭建个人博客</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="http://localhost:1313" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/chensidan" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://chensidan.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>Sidan</span>
  </span>
</div>
<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style>


    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script><!-- NOTE: timeago.js uses the language code format like "zh_CN" (underscore and case sensitive) -->
    var languageCode = "zh-CN".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>








</body>
</html>
